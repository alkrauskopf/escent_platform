<div class="clear">
	<h2 style="float:left;">Content Upload by Frontend</h2>
</div>
<br style="clear:both" />
  <div id="result-box">
<table id="Ablums" class="tablesorter">
	<thead>
		<tr>
			<th>Title</th>
			<th>Type</th>	
			<th>Pending</th>		
			<th></th>
			<th></th>			
			<th></th>			
		</tr>
	</thead>
	<tbody>
	  <% @contents.each do |content| -%>
	  <tr id="<%= content.public_id %>">
	    <td><%= content.title %></td>
	    <td><%= content.content_object_type.content_object_type_group.name rescue "None" %></td>
			<td><%= content.pending ? "Yes" : "No" %>
	    <td>
        <%= button_to_remote  "Edit", {:update => "content_panel", :url => {:controller => :content, :action => :edit, :organization_id => @current_organization, :content_id => content}}, {:class => "fsn-button ui-button ui-state-default ui-corner-all" } %>
	    </td>
      <td>
        <%= button_to_remote "Remove", {:update => "content_panel", :before => "Element.show('loading')", :complete => "Element.hide('loading');", :url => {:controller => :content, :action => :destroy, :content_id => content}}, {:class => "fsn-button ui-button ui-state-default ui-corner-all" } %>
      </td>
      <td>
        <button class="fsn-button ui-button ui-state-default ui-corner-all">
            View
        </button>
			</td>
	  </tr>
	  <% end -%>
	</tbody>  	
</table>
        <div class="digg_pagination">
            <%= will_paginate @contents %>
        </div>
</div>
<br style="clear:both" />
<p>
 <%= button_to_remote "Back", {:update => "content_panel", :url => {:controller => :content, :action => :index, :organization_id => @current_organization}},{:class => "fsn-button ui-button ui-state-default ui-corner-all" } %>
</p>
<br style="clear:both" />
<div id="view-content" title="View Content">
</div>
<script type="text/javascript" charset="utf-8">
	jQ(document).ready(function() {
    function showDialogContent(title, content_id){
         $dialog = jQ("#view-content");
         // next line is broken.		
         $dialog.attr("title", title);
         jQ.post('<%= url_for :controller => :content, :action => :show, :organization_id => @current_organization %>', {
             'id': content_id
         }, function(data){
             $dialog.html(data);
             $dialog.dialog('open');
         })
     }
    var addButtonAction = function(){
        jQ("button", jQ("#result-box")).each(function(){
            jQ(this).click(function(){
                var title = jQ(this).parent("td").parent("tr").children("td").eq(0).text();
                var content_id = jQ(this).parent("td").parent("tr").attr("id");
                showDialogContent(title, content_id)
                return false;
            })
        })
		}		
    jQ("#view-content").dialog({
        bgiframe: true,
        autoOpen: false,
        width: 500,
        modal: true,
        buttons: {
            Close: function(){
                jQ(this).dialog('close');
            }
        }
    });	
    addButtonAction();	
	})
</script>