<% form_for([:admin, @fundraising_campaign]) do |f| %>
  <%= f.error_messages %>
  <%= hidden_field_tag "organization_id", @current_organization.public_id %>
 <div class="FormRow">
    <div class="FormRowTitle">
      <%= f.label :name %>
    </div>
    <div class="FormRowData">
      <%= f.text_field :name %>
    </div>
  </div>
  <div class="FormRow">
    <div class="FormRowTitle">
      <%= f.label :description %>
    </div>
    <div class="FormRowData">
      <%= f.text_area :description, :rows => 5 %>
    </div>
  </div>
		
  <div class="FormRow">
    <div class="FormRowTitle">
      <%= f.label :starts_at %>
    </div>
    <div class="FormRowData">
      <%= f.calendar_date_select :starts_at %>
    </div>
  </div>
  <div class="FormRow">
    <div class="FormRowTitle">
      <%= f.label :ends_at %>
    </div>
    <div class="FormRowData">   	
	    <%= check_box_tag "no_end_date", 1, !@fundraising_campaign.ends_at?, :id => "no_end_date" %> No scheduled close
	  	<div id="end_date_panel" style="<%= 'display: none;' unless @fundraising_campaign.ends_at? %>">   
      <%= f.calendar_date_select :ends_at %>
    </div>
  </div>

  <div class="FormRow">
    <div class="FormRowTitle">
      <%= f.label :goal_amount %>
    </div>
    <div class="FormRowData">
      <%= f.text_field :goal_amount %>
    </div>
  </div>
  <div class="FormRow">
    <div class="FormRowTitle">
      <%= f.submit @fundraising_campaign.id.blank? ? 'Create' : 'Update' %>
    </div>
  </div>
<% end %>

<%= link_to 'Back', admin_fundraising_campaigns_path, :id => 'back_to_index' %>

<script type="text/javascript">
jQ(document).ready(function() {
  jQ("#no_end_date").change(function() {
	  if (jQ("#no_end_date").attr("checked")) {
		  jQ("#end_date_panel").slideUp("slow");
		} else {
		  jQ("#end_date_panel").slideDown("slow");
		}
	});
	jQ("#back_to_index").click(function() {
		url = "<%= url_for admin_fundraising_campaigns_path %>";
		jQ.get(url, function(data) {
			jQ("#fundraising_campaigns_panel").html(data);
		});
		return false;
	})
	jQ("#new_fundraising_campaign").submit(function() {
		url = jQ(this).attr("action");
		jQ.post(url, jQ(this).serialize(), function(data) {
			jQ("#fundraising_campaigns_panel").html(data);			
		})
		return false;
	})
	jQ(".edit_fundraising_campaign").submit(function() {
		url = jQ(this).attr("action");
		jQ.post(url, jQ(this).serialize(), function(data) {
			jQ("#fundraising_campaigns_panel").html(data);			
		})
		return false;
	})
});
</script>