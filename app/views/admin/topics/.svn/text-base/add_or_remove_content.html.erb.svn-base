<%= render :partial => "/admin/topics/content", :collection => @topic.contents %>
<script type="text/javascript">
	jQ(document).ready(function() {
		function showDialogContent(title, content_id) {
			$dialog = jQ("#view-content");
			// next line is broken.		
			$dialog.attr("title", title);
			jQ.post('<%= url_for :controller => :content, :action => :show, :organization_id => @current_organization %>', {'id':content_id}, function(data) {
				$dialog.html(data);
				$dialog.dialog('open');
			})
		}

		var addButtonAction = function() {
			jQ("button", jQ("#topic_content")).each(function() {
				jQ(this).click(function() {
					var title = jQ(this).parent("td").parent("tr").children("td").eq(0).text();
					var content_id = jQ(this).parent("td").parent("tr").attr("id");
					showDialogContent(title, content_id)
					return false;
				})
			})
		}
		jQ('.dialog').dialog('close');
		addButtonAction();

		jQ('#topic_content input[type=radio]').click(function(event){
			var topic_id = "<%=@topic.public_id%>";
			jQ.post("/admin/topics/set_featured_content/<%=@current_organization.public_id%>",{content_id: event.target.value, id: topic_id},
				function(data){
				jQ("#update_notice").css("display","block");
					jQ("#update_notice").html(data);	
				})
		})	
	})
</script>