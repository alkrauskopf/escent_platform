<div id="manage_indicators_<%= framework.public_id%>">
	<% if framework.organization.provider?(app) -%>

		<div>
			<table style="width:750px;margin-left:0px; border:0px solid #ddd;">
				<tbody>  
					<tr  style="border:0px solid #ddd;" >
                        <td   id = "indicators_activity" style="border:0px solid #ddd; vertical-align:middle; width:305px; padding-left:0px; padding-right:0px; padding-top:0px; text-align:center; font-size:10.5px; font-weight:normal">
                            <%=  select(:elt, :type,   to_activities.collect{|t| [t.elt_framework.abbrev + ": " + t.name, t.id]}, :prompt => activity.nil? ? "Select Activity" : activity.name) %>
                        </td>
                      <td   id = "source_activity" style="border:0px solid #ddd; vertical-align:middle;  width:420px; padding-left:0px; padding-right:0px; padding-top:0px; text-align:center; font-size:10.5px; font-weight:normal">
                        <% if activity %>
                            <%=  select(:elt, :activity, from_activities.collect{|t| [t.organization.short_name + ": " +t.elt_framework.abbrev + ": " + t.name, t.id]}, :prompt => from_activity.nil? ? "Copy From Selected Activity" : (from_activity.organization.short_name + ": " + from_activity.elt_framework.abbrev + ": " + from_activity.name)) %>
                            <script type="text/javascript">
                                jQ(document).ready(function() {
                                    jQ('#source_activity').change(function() {
                                        var source_id = jQ('#elt_activity').val();
                                        var url = "<%= url_for :controller => "/apps/learning_time", :action => :select_source_activity, :organization_id => @current_organization, :activity_id => activity.id, :app_id=> app.id %>";
                                        jQ.get(url, {'from_activity_id':source_id}, function(data) {
                                            jQ("#manage_indicators_<%= framework.public_id%>").html(data);
                                            jQ("#manage_indicators_<%= framework.public_id%>").show();
                                        });
                                    })
                                });
                            </script>
                        <% else -%>
                            &nbsp;
                        <% end %>
                      </td>
                    </tr>
				</tbody>
			</table>	
		</div>

	<script type="text/javascript">
	jQ(document).ready(function() {
		jQ('#indicators_activity').change(function() {
			var activity_id = jQ('#elt_type').val();
			var url = "<%= url_for :controller => "/apps/learning_time", :action => :select_activity, :organization_id => @current_organization, :app_id=> app.id %>";
				jQ.get(url, {'activity_id':activity_id}, function(data) {
				jQ("#manage_indicators_<%= framework.public_id%>").html(data);
		   		jQ("#manage_indicators_<%= framework.public_id%>").show();
				});
		})
	});
	</script>

        <div style = "margin-top:20px;">
          <% if from_activity && activity && activity.organization -%>
              <div>
                <table style="width:750px;margin-left:0px; border:0px solid #ddd;">
                  <tbody>
                  <tr  style="border:0px solid #ddd;" >
                    <td   id = "from_element" style="border:0px solid #ddd; vertical-align:middle; width:305px;  padding-left:0px; padding-right:0px; padding-top:0px; text-align:center; font-size:10.5px; font-weight:normal">
                      <%=  select(:elt, :to_element,  activity.elt_framework.elt_elements.collect{|e| [e.name, e.public_id]}, :prompt => to_element.nil? ? "Select Element" : to_element.name) %>
                    </td>
                    <td   id = "copy_activity" style="border:0px solid #ddd; vertical-align:middle;  width:420px; padding-left:0px; padding-right:0px; padding-top:0px; text-align:center; font-size:10.5px; font-weight:normal">
                      <% if to_element %>
                          <%=  select(:elt, :from_element,  from_activity.elt_framework.elt_elements.collect{|e| [e.name, e.public_id]}, :prompt =>  "Copy From Selected Element") %>
                          <script type="text/javascript">
                              jQ(document).ready(function() {
                                  jQ('#copy_activity').change(function() {
                                      var elt_element_id = jQ('#elt_from_element').val();
                                      var url = "<%= url_for :controller => "/apps/learning_time", :action => :copy_activity_indicators, :organization_id => @current_organization, :activity_id => activity.id, :from_activity_id => from_activity.id, :to_element_id => to_element.id, :app_id=> app.id %>";
                                      jQ.get(url, {'elt_element_id':elt_element_id}, function(data) {
                                          jQ("#manage_indicators_<%= framework.public_id%>").html(data);
                                          jQ("#manage_indicators_<%= framework.public_id%>").show();
                                      });
                                  })
                              });
                          </script>
                      <% else -%>
                          &nbsp;
                      <% end %>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
              <script type="text/javascript">
                  jQ(document).ready(function() {
                      jQ('#from_element').change(function() {
                          var elt_element_id = jQ('#elt_to_element').val();
                          var url = "<%= url_for :controller => "/apps/learning_time", :action => :select_element, :organization_id => @current_organization, :activity_id => activity.id, :from_activity_id => from_activity.id, :app_id=> app.id %>";
                          jQ.get(url, {'elt_element_id':elt_element_id}, function(data) {
                              jQ("#manage_indicators_<%= framework.public_id%>").html(data);
                              jQ("#manage_indicators_<%= framework.public_id%>").show();
                          });
                      })
                  });
              </script>

          <% end %>
          <% if activity && activity.organization %>

			<table  style="width:750px; width:fixed; border-top:0px solid #000; margin-top:10px; margin-bottom:0px; margin-left:0px">
				<tbody>  
					<tr>
						<td style=" text-align:center; color: #2061a5;; font-size:14px; font-weight:bold; ">
							<%= activity.name %>
						</td>
					</tr>
				</tbody>
			</table>
			<% activity.elt_framework.elt_elements.each do |element| -%>
				<%= render :partial => "/apps/learning_time/manage_element_indicators", :locals => {:activity => activity, :element => element, :app=>app}%>
			<% end -%>
          <% end %>
	    </div>
	<% end -%>
</div>








