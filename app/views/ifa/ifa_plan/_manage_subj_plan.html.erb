<div id="manage_plan_<%=subject.public_id%>">
  <% if @current_user.ifa_plan_subject(subject).nil? %>
    <div class="row ifa_panel_title">
      <div class="button_blue" id="create_plan_<%=subject.id%>">
        Create Plan
      </div>
    </div>
  <% else %>
    <% if !show_form %>
      <div  class="ifa_subject_plan_box ">
        <div class= "precision_prep_gold_panel">
          <div class="col-md-3">
            <div class="button_gray ifa_plan_button" id="show_form_<%=subject.id%>">
              Update Needs/Goals
            </div>
          </div>
          <div class="col-md-6">
            <%= subject.name.upcase %> Growth Plan
          </div>
          <div class="col-md-3">
            <%= @current_user.full_name.titleize %>
          </div>
        </div>
        <% plan = @current_user.ifa_plan_subject(subject) %>
        <div class="ifa_subject_plan_content">
          <%= render :partial =>  "/ifa/ifa_plan/show_plan", :locals=>{:plan=> plan}%>
        </div>
        <%= render :partial =>  "/ifa/ifa_plan/teacher_remarks", :locals=>{:plan=> plan, :remarks => plan.remarks, :show_form=>false} %>
        <div class= "precision_prep_slay_panel">
          <div class="ifa_plan_header_label">
            <%= pluralize(plan.milestones.size, ' Student Milestone') %>
          </div>
        </div>
        <div class="row ifa_subject_plan_content">
          <div class="col-md-12">
            <% ActStandard.for_standard_and_subject(@current_standard, subject).each do |strand| %>
              <%= render :partial =>  "/ifa/ifa_plan/strand_milestones", :locals=>{:plan=>@current_user.ifa_plan_subject(subject), :strand => strand, :new_milestone=>nil}%>
            <% end %>
          </div>
        </div>
      </div>
    <% else %>
          <%= render :partial =>  "/ifa/ifa_plan/form_plan", :locals=>{:plan=>@current_user.ifa_plan_subject(subject)}%>
        <% end %>
      <% end %>

</div>
<script type="text/javascript">
  jQ(document).ready(function() {
    jQ('#create_plan_<%=subject.id%>').click(function() {
      var url = "<%= ifa_plan_create_url(:organization_id => @current_organization, :subject_id => subject.id) %>";
      jQ.get(url, {}, function(data) {
        jQ("#manage_plan_<%=subject.public_id%>").html(data);
        jQ("#manage_plan_<%=subject.public_id%>").show();
      });
    })
  });
</script>
<script type="text/javascript">
  jQ(document).ready(function() {
    jQ('#show_form_<%=subject.id%>').click(function() {
      var url = "<%= ifa_plan_show_form_url(:organization_id => @current_organization, :subject_id => subject.id) %>";
      jQ.get(url, {}, function(data) {
        jQ("#manage_plan_<%=subject.public_id%>").html(data);
        jQ("#manage_plan_<%=subject.public_id%>").show();
      });
    })
  });
</script>
