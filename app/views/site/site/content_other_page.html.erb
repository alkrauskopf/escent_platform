<div id="content_panel">
    <div id="result-box">
    	<br />
    	<h2>Photo Album (<%= @content_count %>)</h2> <!-- HACK for July 28 2009 Demo -->
        <table class="tablesorter">
			<thead>
				<th>Title</td>
				<th>&nbsp;</td>		
				<th>Discription (Pull from Caption)</td>
				<th>&nbsp;</td>
													
			</thead>			
            <tbody id="search-results">
                <% unless @contents.empty? %>
                <% for content in @contents do -%>
                <tr id="<%= content.public_id %>">
                    <td>
                        <%= content.title %>
                    </td>
                    <td>
                        <%= content.organization.name %>
                    </td>
                    <td>
	                     <%= truncate(content.description , 60) %>
                        <%#= content.content_object_type.content_object_type_group.name unless content.content_object_type.nil? %>
                    </td>
                    <td style="width:50px; padding-top:3px;">
                      <button class="fsn-button ui-button ui-state-default ui-corner-all">
                          View
                      </button>                      
                    </td>
              </tr>
                <% end %>
                <% else %>
                <tr>
                    <td colspan="4" style="text-align:center;">
                        No Content
                    </td>
                </tr>
                <% end %>
            </tbody>
        </table>
        <div id="digg_other_pagination" class="digg_pagination">
            <%= will_paginate @contents , :params => {:action => "content_other_page" , :organization_id=> @current_organization.public_id} %>
        </div>
    </div>
</div>
<script type="text/javascript">
    jQ(document).ready(function(){
        var $resultsBox = jQ("#search-results");
        var $image_resultsBox = jQ("#image_results")
        var $video_resultsBox = jQ("#video_results")       

        var AUTH_TOKEN = "<%= protect_against_forgery? ? form_authenticity_token : '' %>";
        jQ.ajaxSetup({ data: { authenticity_token: AUTH_TOKEN } });
        
        function showDialogContent(content_id){
            $dialog = jQ("#view-content");
            jQ.post('<%= url_for :controller => "admin/content", :action => :show, :organization_id => @current_organization %>', {
                'id': content_id
            }, function(data){
                $dialog.html(data);
                $dialog.dialog('open');
            })
        }
        
        var addButtonAction = function(){
            jQ("button", $resultsBox).each(function(){
                jQ(this).click(function(){
                    var content_id = jQ(this).parent("td").parent("tr").attr("id");
                    showDialogContent(content_id)
                    return false;
                })
            })
            jQ("button", $image_resultsBox).each(function(){
                jQ(this).click(function(){
                    var content_id = jQ(this).parent("li").attr("id");
                    showDialogContent(content_id)
                    return false;
                })
            })
            jQ("button", $video_resultsBox).each(function(){
                jQ(this).click(function(){
                    var content_id = jQ(this).parent("li").attr("id");
                    showDialogContent(content_id)
                    return false;
                })
            })
        }
        addButtonAction();

        jQ("#view-content").dialog({
            bgiframe: true,
            autoOpen: false,
            width: 500,
            modal: true,
            buttons: {
                Close: function(){
                    jQ(this).dialog('close');
                }
            }
       });
})
</script>