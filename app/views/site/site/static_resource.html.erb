<style type="text/css" media="screen">
    .warp_content {
        padding: 0;
        background-color: transparent;
    }
</style>
<script type="text/javascript" charset="utf-8">
    jQ(document).ready(function(){
        //jQ("#call_to_action").addImageShadow();
        //jQ("#followup").addImageShadow();
    })
</script>
<div id="mainContent">
	<% button_label = "Download" %>
	<% past_verb = "View" %>
	<% unless @content.content_object_type.nil? -%>
		<% if [4,2,1].include?(@content.content_object_type.content_object_type_group_id)%><% button_label = "View"%> <% past_verb = "View" %> <% end %>
		<% if [3].include?(@content.content_object_type.content_object_type_group_id)%><% button_label = "Listen"%><% past_verb = "Listen"%> <% end %>
		<% if [5].include?(@content.content_object_type.content_object_type_group_id)%><% then button_label = "View Link"%> <% past_verb = "View"%><% end %>
	<% end -%>
<!-- ALK:  Tabled Container because I screwed up the CCS container, and can't get it to work for all browsers.  -->

	<table style="width:94%; margin:0; border:0px solid #ddd;vertical-align:top;">
		<style type="text/css" media="screen">
	    		table,tr,td { border:none }
				table tr:hover{
        		background-color: transparent;
      			}
		</style>
		<tbody>  
			<tr  style="border:0px solid #ddd;" >
				<td style="width:35%; width:fixed; margin-left:0px; border-right:1px dashed #ddd;vertical-align:top;">
<div id="leftpane_res">
		<%= render :partial => "site/site/static_resource_left", :locals=> {:content => @content} %>
</div>
				</td>
				<td style=" width:65%; width:fixed; margin-left:0px; border:0px solid #ddd;vertical-align:top;">

<div id="rightpane_res">	

		<%= render :partial => "site/site/static_resource_right", :locals=> {:content => @content} %>

	 
	 <div style="float:left; width:400px;font-size:12px; word-wrap:break-word; text-align:center; font-weight:normal; color:#000000;">

  <script type="text/javascript">
    jQ(document).ready(function(){
      var $resultsBox = jQ("#search-results");
      var url = '<%= url_for :controller => :content, :action => :search, :organization_id => @current_organization %>';
      var AUTH_TOKEN = "<%= protect_against_forgery? ? form_authenticity_token : '' %>";
      jQ.ajaxSetup({
        data: {
          authenticity_token: AUTH_TOKEN
        }
      });
        
      function showDialogContent(title, content_id){
        $dialog = jQ("#view-content");
        // next line is broken.
        $dialog.attr("title", title);
        jQ.post('<%= url_for :controller => :content, :action => :show, :organization_id => @current_organization %>', {
          'id': content_id
        }, function(data){
          $dialog.html(data);
          $dialog.dialog('open');
        })
      }
        
      var addButtonAction = function(){
        jQ("button", jQ("#result-box")).each(function(){
          jQ(this).click(function(){
            var title = jQ(this).parent("td").parent("tr").children("td").eq(0).text();
            var content_id = jQ(this).parent("td").parent("tr").attr("id");
            showDialogContent(title, content_id)
            return false;
          })
        })
			
        jQ("#show_all_content").click(function(){
          jQ("#content_keywords").attr("value","");
          jQ("#show_all_content").css("display", "none");
          search_content(url,"");
          return false;
        })
      }
        
      function search_content(url, keywords){
        jQ.get(url, {
          'keywords': keywords,
          'render_html': 'search_results'
        }, function(data){
          jQ('#result-box').html(data)
          addButtonAction();
        });
      }
        
      jQ("#search_button").click(function(){
        var keywords = jQ("input[name='keywords']", jQ(this).parent("div")).val();
			
        if(keywords.length == 0){
          jQ("#show_all_content").css("display", "none");
        }else{
          jQ("#show_all_content").css("display", "block");
        }

        search_content(url, keywords);
      });
        
      jQ("#content_keywords").keyup(function(event){
        if (event.keyCode == 13) {
          var keywords = jQ(this).val();
          search_content(url, keywords);
        }
      });
        
      addButtonAction();
        
      search_content(url, '');
        
      jQ("#view-content").dialog({
        bgiframe: true,
        autoOpen: false,
        width: 500,
        modal: true,
        buttons: {
          Close: function(){
            jQ(this).dialog('close');
          }
        }
      });
        
      jQ('div#result-box div.pagination a').live('click', function(){
        jQ('#result-box').load(this.href, function(){
          addButtonAction();
        });
        return false
      })
    })
  </script>


  <br style="clear:both">

  <%= render(:partial => "resource") %>
 
</div> 
<div id="view-content" title="View Content">
</div> 
</div>
				</td>
			</tr>
		</tbody>
	</table>


</div>
